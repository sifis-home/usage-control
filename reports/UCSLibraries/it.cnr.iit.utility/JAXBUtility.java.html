<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>JAXBUtility.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">coverage</a> &gt; <a href="../index.html" class="el_bundle">UCSLibraries</a> &gt; <a href="index.source.html" class="el_package">it.cnr.iit.utility</a> &gt; <span class="el_source">JAXBUtility.java</span></div><h1>JAXBUtility.java</h1><pre class="source lang-java linenums">/*******************************************************************************
 * Copyright 2018 IIT-CNR
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 ******************************************************************************/
package it.cnr.iit.utility;

import javax.xml.bind.*;
import javax.xml.namespace.QName;
import javax.xml.transform.Source;
import javax.xml.transform.stream.StreamSource;
import java.io.ByteArrayInputStream;
import java.io.StringWriter;

/**
 * This is the class devoted to store the utility required to deal with the
 * JAXB.
 *
 * @author antonio
 */
public final class JAXBUtility {

    private JAXBUtility() {

    }

    // constant that represents the schema we're using
    public static final String SCHEMA = &quot;urn:oasis:names:tc:xacml:3.0:core:schema:wd-17&quot;;

    /**
     * Takes an object whose skeleton has been provided by the xjc utility and
     * marshals it into a string that represents the xml
     *
     * @param clazz  the class to which the object belongs
     * @param object the object itself
     * @param name   the name of the class of the object
     * @param schema the schema to be used, it can be null
     * @return a String that represents the xml of the object
     * @throws JAXBException
     */
    public static &lt;T&gt; String marshalToString(Class&lt;T&gt; clazz, T object,
                                             String name, String schema) throws JAXBException {
<span class="fc" id="L53">        JAXBContext jaxbContext = JAXBContext.newInstance(clazz);</span>
<span class="fc" id="L54">        Marshaller jaxbMarshaller = jaxbContext.createMarshaller();</span>
<span class="fc" id="L55">        jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);</span>

<span class="fc" id="L57">        QName qName = new QName(schema, name);</span>
<span class="fc" id="L58">        JAXBElement&lt;T&gt; elem = new JAXBElement&lt;&gt;(qName, clazz, null, object);</span>

<span class="fc" id="L60">        StringWriter stringWriter = new StringWriter();</span>
<span class="fc" id="L61">        jaxbMarshaller.marshal(elem, stringWriter);</span>

<span class="fc" id="L63">        return stringWriter.getBuffer().toString();</span>
    }

    /**
     * Takes a String that represents the content of an xml and converts it into
     * one of the objects provided by the xjc tool.
     *
     * @param clazz     the class to which the object belongs
     * @param xmlString the xml in string format
     * @return the object built up after unmarshalling, null otherwise
     * @throws JAXBException
     */
    public static &lt;T&gt; T unmarshalToObject(Class&lt;T&gt; clazz, String xmlString) throws JAXBException {
<span class="fc bfc" id="L76" title="All 2 branches covered.">        if (xmlString == null) {</span>
<span class="fc" id="L77">            throw new JAXBException(&quot;The XML String was null&quot;);</span>
        }
<span class="fc" id="L79">        JAXBContext jaxbContext = JAXBContext.newInstance(clazz);</span>
<span class="fc" id="L80">        Unmarshaller jaxbUnmarshaller = jaxbContext.createUnmarshaller();</span>
<span class="fc" id="L81">        Source stream = new StreamSource(</span>
<span class="fc" id="L82">                new ByteArrayInputStream(xmlString.getBytes()));</span>
<span class="fc" id="L83">        JAXBElement&lt;T&gt; element = jaxbUnmarshaller.unmarshal(stream, clazz);</span>

<span class="fc" id="L85">        return element.getValue();</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.10.202304240956</span></div></body></html>